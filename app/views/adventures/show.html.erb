<%#
<div class="adventure-play">
  <div class="flex-1 overflow-hidden">
    <div class="w-full border-b border-black/10 dark:border-gray-900/50 text-gray-800 dark:text-gray-100 group bg-gray-50 dark:bg-[#444654]">
      <div class="text-base gap-4 md:gap-6 m-auto md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0">
        <div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]">
          <div class="flex flex-grow flex-col gap-3">
            <div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">
              <div class="markdown prose w-full break-words dark:prose-invert light">
                <p><strong>Gamemaster:</strong></p>
                <p>You enter the inn and the smell of ale and stew waft through the air. The walls are lined with tapestries and the tables are filled with lively conversations. The barmaid greets you with a smile and asks what she can do for you. You can take a seat at a table, order an ale, ask the barmaid for gossip, or ask the barmaid to show you to a room for the night.</p>
                <p>What would you like to do?</p>
                <ul>
                  <li>Kill everyone</li>
                  <li>Drink a beer</li>
                  <li>Sit at a table</li>
                  <li>Go out</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="flex flex-col items-center text-sm dark:bg-gray-800">
      <div class="w-full border-b border-black/10 dark:border-gray-900/50 text-gray-800 dark:text-gray-100 group dark:bg-gray-800">
        <div class="text-base gap-4 md:gap-6 m-auto md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0">
          <div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]">
            <div class="flex flex-grow flex-col gap-3">
              <p><strong>Player:</strong></p>
              <div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">1</div>
            </div>
            <div class="flex justify-between"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="w-full border-b border-black/10 dark:border-gray-900/50 text-gray-800 dark:text-gray-100 group bg-gray-50 dark:bg-[#444654]">
      <div class="text-base gap-4 md:gap-6 m-auto md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0">
        <div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]">
          <div class="flex flex-grow flex-col gap-3">
            <div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">
              <div class="markdown prose w-full break-words dark:prose-invert light">
                <p><strong>Gamemaster:</strong></p>
                <p>This isn't something you can do here. You can take a seat at a table, order an ale, ask the barmaid for gossip, or ask the barmaid to show you to a room for the night.</p>
                <p>What would you like to do?</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="absolute bottom-0 left-0 w-full border-t md:border-t-0 dark:border-white/20 md:border-transparent md:dark:border-transparent md:bg-vert-light-gradient bg-white dark:bg-gray-800 md:!bg-transparent dark:md:bg-vert-dark-gradient">
  <form class="stretch mx-2 flex flex-row gap-3 pt-2 last:mb-2 md:last:mb-6 lg:mx-auto lg:max-w-3xl lg:pt-6">
    <div class="relative flex h-full flex-1 md:flex-col">
      <div class="flex flex-col w-full py-2 flex-grow md:py-3 md:pl-4 relative border border-black/10 bg-white dark:border-gray-900/50 dark:text-white dark:bg-gray-700 rounded-md shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:shadow-[0_0_15px_rgba(0,0,0,0.10)]">
        <textarea tabindex="0" data-id="aa5b9775-1bda-4786-8e9d-c84ef4b0ce35" rows="1" class="m-0 w-full resize-none border-0 bg-transparent p-0 pl-2 pr-7 focus:ring-0 focus-visible:ring-0 dark:bg-transparent md:pl-0" style="max-height: 200px; height: 24px; overflow-y: hidden;"></textarea>
        <button class="absolute p-1 rounded-md text-gray-500 bottom-1.5 right-1 md:bottom-2.5 md:right-2 hover:bg-gray-100 dark:hover:text-gray-400 dark:hover:bg-gray-900 disabled:hover:bg-transparent dark:disabled:hover:bg-transparent">
          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mr-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
    </div>
  </form>
</div> %>


    <%#= simple_form_for @adventure, class: "d-flex chat-control" do |f| %>
      <%#= f.input :save_adventure, placeholder: '', input_html: { value: '' }, class: "chat-input" %>
      <%#= f.button :submit, class: "btn-play"%>
    <%# end %>



<%# <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#adventureStart">
  Launch demo modal
</button> %>

<div class="adventure-play">
  <div class="container p-5">
    <h1 class="mb-4">Play your adventure</h1>
    <div class="chat-content">
      <% @messages.each do |message| %>
        <div class="row mb-3">
          <div class="col-2">
            <p class="me-3"><strong>
              <% case message.role %>
                <% when "user" %>
                  <%= message.user.username %>
                <% when "assistant" %>
                  Gamemaster
              <% end %>
            </strong></p>
          </div>
          <div class="col-10">
            <p style="white-space: pre-line;"><%= message.content %></p>
          </div>
        </div>
      <% end %>
    </div>
      <div class="chat-input mt-3">
        <%= simple_form_for [@adventure, @message], wrapper: :inline_form, html: { class: 'row' } do |f| %>
          <div class="col-10">
            <%= f.input :content, label: false, placeholder: "Number of the action or simply write: I want to ..."%>
          </div>
          <div class="col-2">
            <%= f.button :submit, value: "Send", class: "btn-play "%>
          </div>
        <% end %>
      </div>

  </div>
</div>

<div data-controller="adventure-modal">
  <div class="modal fade show <%#= d-block %>"  id="adventureStart" tabindex="-1" aria-labelledby="adventureStartLabel" aria-modal="true" role="dialog" data-adventure-modal-target="adventureStart">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content align-item-center">
        <div class="modal-content-adventure">
          <div class="container mt-5">
            <div class="d-flex justify-content-between">
              <h1 class="modal-title fs-4" id="adventureStartLabel">Your adventure start here</h1>
              <button type="button" class="btn-close" data-action="click->adventure-modal#close" aria-label="Close"></button>
            </div>
            <p><%= @adventure.character.universe.description %></p>
            <div>
              <img src=<%= @adventure.character.universe.image_url %> alt="" width="100%">
            </div>
          </div>
          <div class="footer-modal">
            <button type="button" class="btn btn-secondary" data-action="click->adventure-modal#close">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
